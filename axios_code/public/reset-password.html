<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Reset Password</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
  body { font-family: Arial, sans-serif; background: #f5f6fa; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
  .form-container { background: #fff; padding: 30px 40px; border-radius: 10px; box-shadow: 0 6px 18px rgba(15,23,42,0.08); width: 100%; max-width: 400px; box-sizing: border-box; }
  h2 { text-align: center; margin-bottom: 25px; color: #222; }
  label { display: block; margin-bottom: 6px; font-weight: 500; }
  input { width: 100%; padding: 12px; margin-bottom: 15px; border-radius: 6px; border: 1px solid #ccc; font-size: 14px; outline: none; box-sizing: border-box; box-shadow: inset 0 1px 3px rgba(0,0,0,0.08); transition: all 0.2s ease; }
  input:hover { border-color: #ff3b3b; }
  input:focus { border-color: #ff3b3b; box-shadow: 0 0 5px rgba(255,59,59,0.3); background: #fff; }
  button { width: 100%; padding: 12px; border: none; border-radius: 6px; background: #ff3b3b; color: #fff; font-weight: 600; font-size: 16px; cursor: pointer; transition: all 0.2s ease; box-shadow: 0 4px 12px rgba(255,59,59,0.2); }
  button:hover { transform: translateY(-2px); box-shadow: 0 6px 16px rgba(255,59,59,0.25); }
 .message { font-size: 14px; margin-top: 5px; }
 .message.error { color: red; }
</style>
</head>
<body>
  <div class="form-container">
    <h2>Reset Password</h2>
    <label for="currentPassword">Current Password</label>
    <input type="password" id="currentPassword" placeholder="Enter current password" />
    <label for="newPassword">New Password</label>
    <input type="password" id="newPassword" placeholder="Enter new password" />
    <button id="resetBtn">Reset Password</button>
	<p id="msg" class="message"></p>
  </div>

<script>
  const msg = document.getElementById('msg');
  const phone = localStorage.getItem("phone");
  if(!phone){
    msg.textContent = '⚠️ Please Login  First';
    window.location.replace("login.html");
  }

  const resetBtn = document.getElementById("resetBtn");
  resetBtn.addEventListener("click", async () => {
    const currentPassword = document.getElementById("currentPassword").value.trim();
    const newPassword = document.getElementById("newPassword").value.trim();
    if(!currentPassword || !newPassword) return alert("Enter both fields");

    try{
      const res = await fetch("/api/reset-password", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ phone, currentPassword, newPassword })
      });
      const data = await res.json();
      if(data.success){
        alert("✅ Password reset successful");
        window.location.replace("login.html");
      } else {
        alert(data.message || "Error resetting password");
      }
    } catch(err){
      console.error(err);
      alert("Error resetting password");
    }
  });
</script>
</body>
</html>
